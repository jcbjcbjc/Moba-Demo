{"version":3,"sources":["file:///D:/LearningFrameWork/MobaYan/Moba/Src/Client/assets/Scripts/Services/BattleService.ts"],"names":["BattleService","LogUtil","proto2","User","NetClientBattle","NetMessageRequest2","FrameHandleResponse","PercentForwardResponse","FrameHandle","PercentForward","GameOverRequest","RepairFrameResponse","RepairFrameRequest","Init","SendFrameHandle","frameHandle","userId","Instance","user","id","request","SendMessage","SendPercentForward","percent","log","percentForward","SendGameOver","gameOverReq","SendRepairFrame","startFrame","endFrame","repairFrameReq","SendRecordUser","console"],"mappings":"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","sourcesContent":["import { LogUtil } from \"../Log/LogUtil\";\r\nimport proto2 from '../../Proto/Battle/proto.js';\r\nimport { MessageBox, MessageBoxType } from \"../UI/Common/MessageBox\";\r\nimport { EventManager } from \"../UI/Common/Event/EventManager\";\r\nimport { EventType } from \"../UI/Common/Event/EventType\";\r\nimport { SocketConst } from \"../Network/SocketConst\";\r\nimport { User } from \"../Models/User\";\r\nimport { director } from \"cc\";\r\nimport { SoundManager } from \"../../Sound/SoundManager\";\r\nimport { SoundDefine } from \"../../Sound/SoundDefine\";\r\nimport { TipsManager } from \"../UI/TipsManager\";\r\nimport { NetClientBattle } from \"../Network/Battle/NetClientBattle\";\r\nconst { NetMessageRequest2,FrameHandleResponse,PercentForwardResponse,FrameHandle,PercentForward, GameOverRequest,\r\n    RepairFrameResponse, RepairFrameRequest} = proto2;\r\n\r\nexport class BattleService{\r\n   public static Instance: BattleService = new BattleService();\r\n\r\n   public Init() {\r\n      \r\n   }\r\n\r\n    /**\r\n     * 发送帧操作\r\n     */\r\n    public SendFrameHandle(frameHandle:FrameHandle): void {\r\n         //LogUtil.log(\"SendFrameHandle\",frameHandle);\r\n        let userId=User.Instance.user.id;\r\n        let request = new NetMessageRequest2();\r\n        request.frameHandle = frameHandle;\r\n        request.frameHandle.userId=userId;\r\n        request.userId=userId;\r\n        NetClientBattle.Instance.SendMessage(request);\r\n    }\r\n\r\n    \r\n    /**\r\n     * 发送进度转发\r\n     */\r\n    public SendPercentForward(percent:number): void {\r\n        LogUtil.log(\"SendPercentForward\");\r\n        let userId=User.Instance.user.id;\r\n        \r\n        let request = new NetMessageRequest2();\r\n        request.percentForward = new PercentForward();\r\n        request.percentForward.userId=userId;\r\n        request.percentForward.percent=percent;\r\n        request.userId=userId;\r\n\r\n        // console.log('request='+JSON.stringify(request))\r\n        NetClientBattle.Instance.SendMessage(request);\r\n    }\r\n    \r\n\r\n      /**\r\n     * 发送游戏结束\r\n     */\r\n    public SendGameOver(): void {\r\n        LogUtil.log(\"SendGameOver\");\r\n        let userId=User.Instance.user.id;\r\n        let request = new NetMessageRequest2();\r\n        request.gameOverReq = new GameOverRequest();\r\n        request.userId=userId;\r\n        NetClientBattle.Instance.SendMessage(request);\r\n    }\r\n\r\n    /**\r\n     * 发送补帧请求\r\n     */\r\n    public SendRepairFrame(startFrame:number, endFrame:number): void {\r\n        // LogUtil.log(\"SendRepairFrame\");\r\n        let userId=User.Instance.user.id;\r\n        let request = new NetMessageRequest2();\r\n        request.repairFrameReq = new RepairFrameRequest();\r\n        request.repairFrameReq.startFrame=startFrame;\r\n        request.repairFrameReq.endFrame=endFrame;\r\n        request.userId=userId;\r\n        NetClientBattle.Instance.SendMessage(request);\r\n    }\r\n\r\n    /**\r\n     * 记录用户请求\r\n     */\r\n    public SendRecordUser(){\r\n        console.log('SendRecordUser')\r\n        let request = new NetMessageRequest2();\r\n        request.userId=User.Instance.user.id;\r\n        NetClientBattle.Instance.SendMessage(request);\r\n    }\r\n}"]}