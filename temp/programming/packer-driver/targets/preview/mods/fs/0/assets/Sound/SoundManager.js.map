{"version":3,"sources":["file:///D:/LearningFrameWork/MobaYan/Moba/Src/Client/assets/Sound/SoundManager.ts"],"names":["_decorator","AudioSource","Component","game","LoadResUtil","LogUtil","SoundConfig","ccclass","property","SoundManager","onLoad","log","Instance","addPersistRootNode","node","audioSource","getComponent","MusicVolume","SoundVolume","MusicOn","SoundOn","musicOn","value","MusicMute","soundOn","SoundMute","musicVolume","SetVolume","soundVolume","PlayMusic","name","clip","load_local_AudioClip","MusicPath","error","playing","stop","play","PlaySound","SoundPath","playOneShot","volume","mute"],"mappings":"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","sourcesContent":["import { _decorator,AudioSource, Component, CCClass, AudioClip, url, game } from \"cc\";\r\nimport { LoadResUtil } from \"../Scripts/Utils/LoadResUtil\";\r\nimport { LogUtil } from \"../Scripts/Log/LogUtil\";\r\nimport { SoundConfig } from \"./SoundConfig\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('SoundManager')\r\nexport class SoundManager extends Component{\r\n    public static Instance:SoundManager=null as unknown as SoundManager;\r\n    private audioSource:AudioSource=null as unknown as AudioSource;\r\n    private MusicPath:string = \"Music/\";\r\n    private SoundPath:string = \"Sound/\";\r\n\r\n    onLoad(){\r\n        LogUtil.log('SoundManager onLoad')\r\n        if(!SoundManager.Instance){\r\n            SoundManager.Instance=this;\r\n            game.addPersistRootNode(this.node);\r\n        }\r\n        this.audioSource = this.getComponent(AudioSource) as AudioSource;\r\n        // console.log(this.audioSource)\r\n        this.MusicVolume = SoundConfig.MusicVolume;\r\n        this.SoundVolume = SoundConfig.SoundVolume;\r\n        this.MusicOn = SoundConfig.MusicOn;\r\n        this.SoundOn = SoundConfig.SoundOn;\r\n    }\r\n    //音乐开关\r\n    private musicOn:boolean=null as unknown as boolean;\r\n    public get MusicOn():boolean{\r\n        return this.musicOn;\r\n    }\r\n    public set MusicOn(value:boolean){\r\n        this.musicOn=value;\r\n        this.MusicMute(!this.musicOn);\r\n    }\r\n\r\n    //音效开关\r\n    private soundOn:boolean=null as unknown as boolean;\r\n    public get SoundOn():boolean{\r\n        return this.soundOn;\r\n    }\r\n    public set SoundOn(value:boolean){\r\n        this.soundOn = value;\r\n        this.SoundMute(!this.soundOn);\r\n    }\r\n\r\n    //音乐声音控制\r\n    public musicVolume:number=null as unknown as number;\r\n    public get MusicVolume():number{\r\n        return this.musicVolume;\r\n    }\r\n    public set MusicVolume(value:number){\r\n        if (this.musicVolume != value){\r\n            this.musicVolume = value;\r\n            if (this.musicOn) this.SetVolume(this.musicVolume);\r\n        }\r\n    }\r\n\r\n    //音效声音控制\r\n    public soundVolume:number=null as unknown as number;\r\n    public get SoundVolume():number{\r\n        return this.soundVolume;\r\n    }\r\n    public set SoundVolume(value:number){\r\n        if (this.soundVolume != value)\r\n        {\r\n            this.soundVolume = value;\r\n            // if (this.soundOn) this.SetVolume(this.soundVolume);\r\n        }\r\n    }\r\n\r\n    public async PlayMusic(name:string){\r\n        let clip=await LoadResUtil.load_local_AudioClip(this.MusicPath + name);\r\n        if(clip==null){\r\n            LogUtil.error(\"PlayMusic not existed name:\",name);\r\n            return;\r\n        }\r\n        if(this.audioSource.playing){\r\n            this.audioSource.stop();\r\n        }\r\n        this.audioSource.clip=clip;\r\n        this.audioSource.play();\r\n    }\r\n\r\n    public async PlaySound(name:string){\r\n        let clip=await LoadResUtil.load_local_AudioClip(this.SoundPath + name);\r\n        if(clip==null){\r\n            LogUtil.error(\"PlaySound not existed name:\",name);\r\n            return;\r\n        }\r\n        if(this.soundOn){            \r\n            this.audioSource.playOneShot(clip,this.soundVolume);\r\n        }\r\n    }\r\n\r\n    private SetVolume(value:number):void{\r\n        this.audioSource.volume=value;\r\n    }\r\n\r\n    private MusicMute(mute:boolean):void{\r\n        this.SetVolume(mute ? 0 : this.musicVolume);\r\n    }\r\n\r\n    private SoundMute(mute:boolean):void{\r\n        // this.SetVolume(mute ? 0 : this.soundVolume);\r\n    }\r\n\r\n\r\n}"]}