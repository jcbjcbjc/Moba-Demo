{"version":3,"sources":["file:///D:/LearningFrameWork/MobaYan/Moba/Src/Client/assets/Scripts/UI/Follow/UIFollow.ts"],"names":["_decorator","Prefab","UIWindow","proto","EventManager","ListView","UIFollowItem","EventType","FollowManager","List","FollowService","ccclass","property","NItem","CombatPowerRankingResponse","NUser","FollowResponse","UIFollow","start","listMain","owner","isAddScene","Instance","addListener","ListView_OnItemSelected","OnItemSelected","FollowListRefieshUI","RefieshUI","SendFollowList","param","uiFollowItem","console","log","ClearList","InitFollow","follows","followList","numItems","length","RemoveAll","OnFollowListRender","node","index","getComponent","AddItem","SetItemInfo","onDestroy","removeListener","removeAll"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, Prefab, instantiate, Button, Label } from 'cc';\r\nimport { UIWindow } from '../Common/UIWindow';\r\nimport { User } from '../../Models/User';\r\nimport proto from '../../../Proto/proto.js';\r\nimport { EventManager } from '../Common/Event/EventManager';\r\nimport { ListView } from '../Common/ListView/ListView';\r\nimport { UIFollowItem } from './UIFollowItem';\r\nimport { ListViewItem } from '../Common/ListView/ListViewItem';\r\nimport { EventType } from '../Common/Event/EventType';\r\nimport { TabView } from '../Common/TabView/TabView';\r\nimport { DataManager } from '../../Managers/DataManager';\r\nimport { MessageBox, MessageBoxType } from '../Common/MessageBox';\r\nimport { ItemService } from '../../Services/ItemService';\r\nimport { UserService } from '../../Services/UserService';\r\nimport { CombatPowerRankingManager } from '../../Managers/CombatPowerRankingManager';\r\nimport { FollowManager } from '../../Managers/FollowManager';\r\nimport List from '../Common/ScrollView/List';\r\nimport { FollowService } from '../../Services/FollowService';\r\nconst { ccclass, property } = _decorator;\r\nconst { NItem, CombatPowerRankingResponse, NUser, FollowResponse } = proto;\r\n\r\n@ccclass('UIFollow')\r\nexport class UIFollow extends UIWindow {\r\n\r\n    @property(List) \r\n    private followList = null as unknown as List;\r\n    @property(Prefab)\r\n    public itemPrefab:Prefab=null as unknown as Prefab;\r\n    @property(ListView)\r\n    public listMain:ListView=null as unknown as ListView;\r\n\r\n    public selectedIndex:number=0;\r\n    private index:number=0;  //选择索引\r\n\r\n    private uiFollowItem:UIFollowItem=null as unknown as UIFollowItem;\r\n\r\n    start () {\r\n        this.listMain.owner=this;\r\n        this.listMain.isAddScene=false;\r\n        EventManager.Instance.addListener(EventType.ListView_OnItemSelected,this.OnItemSelected,this);\r\n        EventManager.Instance.addListener(EventType.FollowListRefieshUI,this.RefieshUI,this);\r\n        FollowService.Instance.SendFollowList();\r\n    }\r\n\r\n    private OnItemSelected(param:any){\r\n        this.uiFollowItem=param[0] as UIFollowItem;\r\n        console.log('OnItemSelected=')\r\n    }\r\n\r\n\r\n    public RefieshUI(){\r\n        this.ClearList();\r\n        this.InitFollow();\r\n    }\r\n\r\n     /**\r\n     * 关注列表初始化\r\n     */\r\n    private InitFollow(){\r\n        let follows = FollowManager.Instance.follows;\r\n        this.followList.numItems = follows ? follows.length : 0; \r\n    }\r\n    \r\n   \r\n\r\n    private ClearList():void{\r\n        this.listMain.RemoveAll();\r\n    }\r\n\r\n     /**\r\n     * 关注列表渲染\r\n     * @param node\r\n     * @param index \r\n     */\r\n    OnFollowListRender(node: Node, index: number) {\r\n        let follows = FollowManager.Instance.follows;\r\n        if(!follows){\r\n            return;\r\n        }\r\n        let uiFollowItem=node.getComponent(UIFollowItem);\r\n        this.listMain.AddItem(node,uiFollowItem as ListViewItem);\r\n        uiFollowItem?.SetItemInfo(follows[index],this);\r\n    }\r\n\r\n\r\n    onDestroy(){\r\n        console.log('onDestroy')\r\n        this.listMain.removeListener();\r\n        EventManager.Instance.removeAll(this);\r\n    }\r\n\r\n}\r\n"]}