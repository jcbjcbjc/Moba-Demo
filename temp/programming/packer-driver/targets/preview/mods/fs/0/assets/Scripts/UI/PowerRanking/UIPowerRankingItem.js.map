{"version":3,"sources":["file:///D:/LearningFrameWork/MobaYan/Moba/Src/Client/assets/Scripts/UI/PowerRanking/UIPowerRankingItem.ts"],"names":["_decorator","Node","Label","Sprite","SystemEventType","ListViewItem","User","proto","EventManager","DataManager","LoadResUtil","UIManager","TipsManager","FollowManager","ccclass","property","NItem","NUser","UIPowerRankingItem","onLoad","index","console","log","node","on","TOUCH_END","onClcik","user","status","uiCharacterDetail","Instance","show","SendCharacterDetail","id","character","tid","showTips","SetItemInfo","uiPowerRanking","characterDefine","characters","cid","imgSprite","spriteFrame","load_local_sprite","Avatar","nickNameLabel","string","nickname","offLineLabel","active","onLineLabel","levelLabel","level","fensiLabel","fenSiCount","attLabel","att","defLabel","def","cancelFollowButton","followButton","isFollow","OnClickFollow","SendFollow","OnClickCancelFollow","onDestroy","removeAll"],"mappings":"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","sourcesContent":["import { ListViewItem } from \"../Common/ListView/ListViewItem\";\r\n\r\nimport { _decorator, Component, Node, Prefab, Label, Sprite, SystemEventType, SpriteFrame, Button } from 'cc';\r\nimport { UIWindow } from '../Common/UIWindow';\r\nimport { User } from '../../Models/User';\r\nimport proto from '../../../Proto/proto.js';\r\nimport { EventManager } from \"../Common/Event/EventManager\";\r\nimport { ListView } from \"../Common/ListView/ListView\";\r\nimport { DataManager } from \"../../Managers/DataManager\";\r\nimport { LoadResUtil } from \"../../Utils/LoadResUtil\";\r\nimport { UIPowerRanking } from \"./UIPowerRanking\";\r\nimport { ShopItemDefine } from \"../../Data/ShopItemDefine\";\r\nimport { ItemDefine } from \"../../Data/ItemDefine\";\r\nimport { CharacterDefine } from \"../../Data/CharacterDefine\";\r\nimport { UserService } from \"../../Services/UserService\";\r\nimport { CombatPowerRankingManager } from \"../../Managers/CombatPowerRankingManager\";\r\nimport { UIManager } from '../Common/UIManager';\r\nimport { UICharacterDetail } from \"../UICharacterDetail/UICharacterDetail\";\r\nimport { TipsManager } from \"../TipsManager\";\r\nimport { FollowManager } from \"../../Managers/FollowManager\";\r\nconst { ccclass, property } = _decorator;\r\nconst { NItem, NUser } = proto;\r\n\r\n@ccclass('UIPowerRankingItem')\r\nexport class UIPowerRankingItem extends ListViewItem {\r\n \r\n    @property(Sprite)\r\n    public imgSprite=null as unknown as Sprite;\r\n    @property(Label)\r\n    public nickNameLabel=null as unknown as Label;\r\n    @property(Node)\r\n    public offLineLabel=null as unknown as Node;\r\n    @property(Node)\r\n    public onLineLabel=null as unknown as Node;\r\n    @property(Label)\r\n    public levelLabel=null as unknown as Label;\r\n    @property(Label)\r\n    public fensiLabel=null as unknown as Label;\r\n    @property(Label)\r\n    public attLabel=null as unknown as Label;\r\n    @property(Label)\r\n    public defLabel=null as unknown as Label;\r\n    @property(Node)\r\n    public cancelFollowButton=null as unknown as Node;\r\n    @property(Node)\r\n    public followButton=null as unknown as Node;\r\n\r\n    // @property(SpriteFrame)\r\n    // public selectBgSpriteFrame=null as unknown as SpriteFrame;\r\n\r\n    // public normalBgSpriteFrame=null as unknown as SpriteFrame;\r\n    // private nodeBgSprite:Sprite=null as unknown as Sprite;\r\n    public shopItemDefine=null as unknown as ShopItemDefine;\r\n    private index:number=0;\r\n    private uiPowerRanking=null as unknown as UIPowerRanking; \r\n\r\n    private user:NUser=null as unknown as NUser; \r\n    onLoad () {\r\n      if(this.index==0){\r\n        console.log('onLoad index='+this.index)\r\n      }\r\n      this.node.on(SystemEventType.TOUCH_END,this.onClcik,this);\r\n      // this.nodeBgSprite=this.node.getComponent(Sprite) as Sprite;\r\n      // this.normalBgSpriteFrame = this.nodeBgSprite.spriteFrame as SpriteFrame;\r\n    }\r\n\r\n    public async onClcik(){\r\n     if(this.user.status){ \r\n       let uiCharacterDetail = await UIManager.Instance.show(\"UICharacterDetail\") as UICharacterDetail;\r\n       uiCharacterDetail.SendCharacterDetail(this.user.id,this.user.character?.tid as number,2);\r\n     }else{\r\n       TipsManager.Instance.showTips('对方不在线！');\r\n     }\r\n    }\r\n\r\n    // public onSelected(selected:boolean):void{\r\n    //   if(this.index==0){\r\n    //     console.log('onSelected index='+this.index)\r\n    //   }\r\n    //     // console.log('selected='+selected)\r\n    //     // if(this.nodeBgSprite){\r\n    //     //    this.nodeBgSprite.spriteFrame = selected ? this.selectBgSpriteFrame : this.normalBgSpriteFrame;\r\n    //     // }\r\n    //     if(selected){  //选中，更新右边详细\r\n    //        this.uiPowerRanking.selectedIndex=this.index;\r\n    //     }\r\n    // }\r\n\r\n    public async SetItemInfo(user:NUser,uiPowerRanking:UIPowerRanking){\r\n      this.user=user;\r\n      this.uiPowerRanking=uiPowerRanking;\r\n      let characterDefine=DataManager.Instance.characters[user.character?.cid as number] as CharacterDefine;\r\n      this.imgSprite.spriteFrame=await LoadResUtil.load_local_sprite(characterDefine.Avatar+'/spriteFrame');\r\n      this.nickNameLabel.string='昵称：'+user.nickname;\r\n      this.offLineLabel.active=!user.status;\r\n      this.onLineLabel.active=user.status;\r\n      this.levelLabel.string='Lv：'+user.character?.level;\r\n      this.fensiLabel.string='粉丝：'+user.fenSiCount;\r\n      this.attLabel.string='攻击力：'+user.character?.att;\r\n      this.defLabel.string='防御力：'+user.character?.def;\r\n      if(User.Instance.user.id==user.id){\r\n        this.cancelFollowButton.active=this.followButton.active=false;\r\n      }else{\r\n        this.cancelFollowButton.active=user.isFollow;\r\n        this.followButton.active=!user.isFollow;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * 点击关注\r\n     */\r\n  public async OnClickFollow(){\r\n      FollowManager.Instance.SendFollow(this.user.id,true);\r\n  }\r\n\r\n  /**\r\n   * 点击取消关注\r\n   */\r\n  public async OnClickCancelFollow(){\r\n    FollowManager.Instance.SendFollow(this.user.id,false);\r\n  }\r\n\r\n\r\n    onDestroy(){\r\n        console.log('onDestroy')\r\n        EventManager.Instance.removeAll(this);\r\n    }\r\n}"]}