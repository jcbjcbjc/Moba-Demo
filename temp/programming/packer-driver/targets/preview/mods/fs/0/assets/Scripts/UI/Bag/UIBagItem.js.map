{"version":3,"sources":["file:///D:/LearningFrameWork/MobaYan/Moba/Src/Client/assets/Scripts/UI/Bag/UIBagItem.ts"],"names":["_decorator","Label","Sprite","SystemEventType","SpriteFrame","ListViewItem","EventManager","DataManager","LoadResUtil","ccclass","property","UIBagItem","start","imgSprite","node","on","TOUCH_END","OnPointerClick","nodeBgSprite","getComponent","normalBgSpriteFrame","spriteFrame","onSelected","selected","console","log","selectBgSpriteFrame","uiBagDetailItem","SetItemInfo","item","uiBag","selectedIndex","index","JSON","stringify","define","Instance","items","itemId","countLabel","string","count","tranLabel","active","isTran","load_local_sprite","Icon","onDestroy","removeAll"],"mappings":"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","sourcesContent":["import { ListViewItem } from \"../Common/ListView/ListViewItem\";\r\n\r\nimport { _decorator, Component, Node, Prefab, Label, Sprite, SystemEventType, SpriteFrame } from 'cc';\r\nimport { UIWindow } from '../Common/UIWindow';\r\nimport { User } from '../../Models/User';\r\nimport { NItem } from '../../../Proto/proto';\r\nimport { EventManager } from \"../Common/Event/EventManager\";\r\nimport { ListView } from \"../Common/ListView/ListView\";\r\nimport { DataManager } from \"../../Managers/DataManager\";\r\nimport { LoadResUtil } from \"../../Utils/LoadResUtil\";\r\nimport { UIBagDetailItem } from \"./UIBagDetailItem\";\r\nimport { UIBag } from \"./UIBag\";\r\nimport { ItemDefine } from \"../../Data/ItemDefine\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('UIBagItem')\r\nexport class UIBagItem extends ListViewItem {\r\n\r\n    @property(Label)\r\n    public countLabel=null as unknown as Label;\r\n    @property(Label)\r\n    public tranLabel=null as unknown as Label;\r\n    @property(Sprite)\r\n    public imgSprite=null as unknown as Sprite;\r\n    @property(SpriteFrame)\r\n    public selectBgSpriteFrame=null as unknown as SpriteFrame;\r\n\r\n    public normalBgSpriteFrame=null as unknown as SpriteFrame;\r\n    private nodeBgSprite:Sprite=null as unknown as Sprite;\r\n    public item=null as unknown as NItem;\r\n    public uiBagDetailItem=null as unknown as UIBagDetailItem;\r\n    public index:number=0;\r\n    private uiBag=null as unknown as UIBag; \r\n    public define=null as unknown as ItemDefine; \r\n\r\n    start () {\r\n      this.imgSprite.node.on(SystemEventType.TOUCH_END,this.OnPointerClick,this);\r\n      this.nodeBgSprite=this.node.getComponent(Sprite) as Sprite;\r\n      this.normalBgSpriteFrame = this.nodeBgSprite.spriteFrame as SpriteFrame;\r\n    }\r\n\r\n    public onSelected(selected:boolean):void{\r\n        console.log('selected='+selected)\r\n        if(this.nodeBgSprite){\r\n           this.nodeBgSprite.spriteFrame = selected ? this.selectBgSpriteFrame : this.normalBgSpriteFrame;\r\n        }\r\n        if(selected){  //选中，更新右边详细\r\n           this.uiBagDetailItem.SetItemInfo(this.item);\r\n           this.uiBag.selectedIndex=this.index;\r\n        }\r\n    }\r\n\r\n    public async SetItemInfo(item:NItem,uiBagDetailItem:UIBagDetailItem,selected:boolean=false,index:number=-1,uiBag:UIBag){\r\n      this.item=item;\r\n      if(index != -1){\r\n        this.index=index;\r\n      }\r\n      this.uiBag=uiBag;\r\n      this.uiBagDetailItem=uiBagDetailItem;\r\n      console.log('UIBagItem SetItemInfo:'+JSON.stringify(item))\r\n      this.define= DataManager.Instance.items[item.itemId];\r\n       this.countLabel.string=item.count+'';\r\n       this.tranLabel.node.active=item.isTran;\r\n       this.imgSprite.spriteFrame=await LoadResUtil.load_local_sprite(this.define.Icon+'/spriteFrame');\r\n       if(selected){\r\n        // this.nodeBgSprite.spriteFrame = this.selectBgSpriteFrame;\r\n        this.OnPointerClick();\r\n        this.uiBagDetailItem.SetItemInfo(item);\r\n       }\r\n      //  console.log('spriteFrame='+this.imgSprite+'，Icon='+this.define.Icon)\r\n       \r\n    }\r\n\r\n\r\n    onDestroy(){\r\n        console.log('onDestroy')\r\n        EventManager.Instance.removeAll(this);\r\n    }\r\n}"]}