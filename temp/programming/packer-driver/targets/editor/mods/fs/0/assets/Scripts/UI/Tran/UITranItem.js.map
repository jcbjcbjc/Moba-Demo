{"version":3,"sources":["file:///D:/LearningFrameWork/MobaYan/Moba/Src/Client/assets/Scripts/UI/Tran/UITranItem.ts"],"names":["_decorator","Label","Sprite","SystemEventType","SpriteFrame","ListViewItem","proto","EventManager","DataManager","LoadResUtil","ccclass","property","NItem","Result","UITranItem","onLoad","index","console","log","node","on","TOUCH_END","OnPointerClick","nodeBgSprite","getComponent","normalBgSpriteFrame","spriteFrame","onSelected","selected","selectBgSpriteFrame","uiTranDetailItem","SetItemInfo","item","itemDefine","uiTran","selectedIndex","Instance","items","itemId","nameLabel","string","Name","count","priceLabel","money","imgSprite","load_local_sprite","Icon","onDestroy","removeAll"],"mappings":"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","sourcesContent":["import { ListViewItem } from \"../Common/ListView/ListViewItem\";\r\n\r\nimport { _decorator, Component, Node, Prefab, Label, Sprite, SystemEventType, SpriteFrame } from 'cc';\r\nimport { UIWindow } from '../Common/UIWindow';\r\nimport { User } from '../../Models/User';\r\nimport proto from '../../../Proto/proto.js';\r\nimport { EventManager } from \"../Common/Event/EventManager\";\r\nimport { ListView } from \"../Common/ListView/ListView\";\r\nimport { DataManager } from \"../../Managers/DataManager\";\r\nimport { LoadResUtil } from \"../../Utils/LoadResUtil\";\r\nimport { UITranDetailItem } from \"./UITranDetailItem\";\r\nimport { UITran } from \"./UITran\";\r\nimport { ShopItemDefine } from \"../../Data/ShopItemDefine\";\r\nimport { ItemDefine } from \"../../Data/ItemDefine\";\r\nconst { ccclass, property } = _decorator;\r\nconst { NItem, Result } = proto;\r\n\r\n@ccclass('UITranItem')\r\nexport class UITranItem extends ListViewItem {\r\n \r\n    @property(Label)\r\n    public countLabel=null as unknown as Label;\r\n    @property(Label)\r\n    public nameLabel=null as unknown as Label;\r\n    @property(Sprite)\r\n    public imgSprite=null as unknown as Sprite;\r\n    @property(Label)\r\n    public priceLabel=null as unknown as Label;\r\n    @property(SpriteFrame)\r\n    public selectBgSpriteFrame=null as unknown as SpriteFrame;\r\n\r\n    public normalBgSpriteFrame=null as unknown as SpriteFrame;\r\n    private nodeBgSprite:Sprite=null as unknown as Sprite;\r\n    public item=null as unknown as NItem;\r\n    public uiTranDetailItem=null as unknown as UITranDetailItem;\r\n    private index:number=0;\r\n    private uiTran=null as unknown as UITran; \r\n    public itemDefine=null as unknown as ItemDefine;\r\n\r\n    onLoad () {\r\n      if(this.index==0){\r\n        console.log('onLoad index='+this.index) \r\n      }\r\n      this.node.on(SystemEventType.TOUCH_END,this.OnPointerClick,this);\r\n      this.nodeBgSprite=this.node.getComponent(Sprite) as Sprite;\r\n      this.normalBgSpriteFrame = this.nodeBgSprite.spriteFrame as SpriteFrame;\r\n    }\r\n\r\n    public async onSelected(selected:boolean):void{\r\n      if(this.index==0){\r\n        console.log('onSelected index='+this.index)\r\n      }\r\n        // console.log('selected='+selected)\r\n        if(this.nodeBgSprite){\r\n           this.nodeBgSprite.spriteFrame = selected ? this.selectBgSpriteFrame : this.normalBgSpriteFrame;\r\n        }\r\n        if(selected){  //选中，更新右边详细\r\n          await this.uiTranDetailItem.SetItemInfo(this.item,this.itemDefine,this.index, this.uiTran);\r\n           this.uiTran.selectedIndex=this.index;\r\n        }\r\n    }\r\n\r\n    public async SetItemInfo(item:NItem,uiTranDetailItem:UITranDetailItem,selected:boolean=false,index:number=-1,uiTran:UITran){\r\n      this.item=item;\r\n      if(index != -1){\r\n        this.index=index;\r\n      }\r\n      this.uiTran=uiTran;\r\n      this.uiTranDetailItem=uiTranDetailItem;\r\n      this.itemDefine= DataManager.Instance.items[item.itemId];\r\n       this.nameLabel.string=this.itemDefine.Name+'x'+item.count;\r\n       this.priceLabel.string=item.money+'';\r\n       this.imgSprite.spriteFrame=await LoadResUtil.load_local_sprite(this.itemDefine.Icon+'/spriteFrame');\r\n       if(selected){\r\n        this.OnPointerClick();\r\n       }\r\n       \r\n    }\r\n\r\n\r\n    onDestroy(){\r\n        console.log('onDestroy')\r\n        EventManager.Instance.removeAll(this);\r\n    }\r\n}"]}